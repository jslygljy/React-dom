<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>React-dom by jslygljy</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <script src="js/react.js"></script>
    <script src="js/react-dom.js"></script>
    <script src="js/director.js"></script>
    <script src="js/browser.min.js"></script>
    <style>
        .input {
            width: 200px;
            height: 200px;
        }
        .listradio{
            width: 50px;height: 50px;border-radius: 50px;border: 1px #000000 solid;display: inline-block;
        }
        .listchoose .listradio{
            background-color: #2b81af;
        }
        .listItem p{display:inline-block}
        .listItem:hover .listClose{
            display: inline-block;
        }
        .listClose{
            color: #A00000;margin-left: 100px;display: none;;
        }
    </style>
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">React-dom</h1>
      <h2 class="project-tagline"></h2>
      <a href="https://github.com/jslygljy/React-dom" class="btn">View on GitHub</a>
      <a href="https://github.com/jslygljy/React-dom/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/jslygljy/React-dom/tarball/master" class="btn">Download .tar.gz</a>
    </section>
    <div id="todoInput"></div>
<script src="js/local.js"></script>
<script type="text/babel">
    (function(){
      'use strict';
	    var ENTER_KEY = 13;
      var Allstats = 'all';
      var Todoinput = React.createClass({
          getInitialState: function () {
              return {
                  currystats : Allstats,
                  TodoItem:'',
                  Todos:app.Utils.store('react-todos')
              };
          },
          inform : function () {
        		app.Utils.store('react-todos', this.state.Todos);
            this.setState({Todos:app.Utils.store('react-todos')})
        	},
          handleChange : function() {
            this.setState({TodoItem:event.target.value})
          },
          onkeyDown: function (event) {
              if(event.keyCode === ENTER_KEY){
                  this.state.Todos = this.state.Todos.concat({
                    title:event.target.value,
                    completed: false
                  });
                  this.inform();
              }
          },
          render: function () {
              return (
                  <div>
                      <input type = "text" val='' className = 'input' placeholder = 'what to do need' onChange={this.handleChange} onKeyDown = {this.onkeyDown}/>
                      <TodoList datas = {this.state.Todos}></TodoList>
                  </div >
              );
          }
      });

      var TodoList = React.createClass({

          getInitialState: function () {
              return {
                  Todos: this.props.datas
              };
          },
          inform : function () {
            app.Utils.store('react-todos',this.state.Todos);
            this.setState({Todos:app.Utils.store('react-todos')})
          },
          handleClick : function (index) {
              var currentata = this.state.Todos[index]
              currentata.completed = !currentata.completed;
              this.inform();
          },
          handleremove:function(index){
              var currentata = this.state.Todos;
              currentata.splice(index,1);
              this.inform();
          },
          handleChange:function(e){
            if(e.target.value === 'all'){
              this.state.Todos = this.state.Todos.map(function (todo) {
                return app.Utils.extend({}, todo, {completed: true});
              });
              this.inform();
            }else{
              this.state.Todos = this.state.Todos.map(function (todo) {
                return app.Utils.extend({}, todo, {completed: false});
              });
              this.inform();
            }
          },
          render: function () {
              var _this = this;
              var main;
              var controllist;
              var todos = app.Utils.store('react-todos');
              if (todos.length>0) {
                main =
                  todos.map(function(data,index){
                      return(
                          <div className='listItem'>
                            <p  className={data.completed?'listchoose':'listli'}
                              onClick={_this.handleClick.bind(_this,index)}>
                              <span className='listradio'></span>
                              {data.title}
                            </p>
                            <span onClick={_this.handleremove.bind(_this,index)} className='listClose'>X</span>
                          </div>
                      )
                  });
                  controllist =
                    <div>
                        <select onChange={this.handleChange}>
                          <option value='all'>全选</option>
                          <option value='no'>全不选</option>
                        </select>
                        <span>clear completed</span>
                    </div>
              }
              return(
                  <div>
                       {main}
                       {controllist}
                  </div>
              )
          }
      })
      ReactDOM.render(<Todoinput/>, document.getElementById('todoInput'));
    })()

</script>
  </body>
</html>
